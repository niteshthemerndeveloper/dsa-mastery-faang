// A tricky recursive function that collects the data as well

